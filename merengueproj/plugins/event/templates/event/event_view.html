{% extends "event/event_base.html" %}

{% load i18n inlinetrans map_tags slide_tags contenttype content_tags event_tags content_filters datefilters rating_tags %}

{% block extrascripts %}
    <script type="text/javascript">
    (function($) {
            $.fn.tabmenu = function (request_query_args, options) {
                var container = $(this);
                $(this).find('li .more').click(function(o){
                    var element = $(this).parent();
                    container.find('.info').hide('slow');
                    container.find('.more').show();
                    container.find('.less').hide();
                    var element_id = element.attr('id');
                    $(element).find('.less').show();
                    $(element).find('.more').hide();
                    $(element).find('.info').show('slow');
                    return false;
                });
                $(this).find('li .less').click(function(o){
                    var element = $(this).parent();
                    $(element).find('.more').show();
                    $(element).find('.less').hide();
                    var element_id = element.attr('id');
                    $(element).find('.info').hide('slow');
                    return false;
                });
             };

            $(document).ready(function(){
                $('ul.occurrencelist').tabmenu();
            });

    })(jQuery);

    </script>
 {{ block.super }}
{% endblock %}

{% block extrahead %}
    {{ block.super }}
    {% ratingmedia %}
    {% google_map_media content=content %}
{% endblock %}

{% block contentbody %}

<p>
  {% if content.categories.count %}
    <strong>{% inline_trans  "Event Type" %}:</strong> {% event_categories content %}
  {% endif %}
</p>
{% if parent %}
<div class="parentEvent">{% inline_trans "This event is part of" %}: <a href="{{ parent.get_absolute_url }}">{{ parent }}</a></div>
{% endif %}

{% related_events content %}

{% if content.is_superevent_with_occurrences %}
    {% with content.occurrence_event.visibles as occurrences %}
    {% if occurrences %}
        <h2>{% inline_trans "When & Where?" %}</h2>
        <ul class="occurrencelist">
        {% for occurrence in content.occurrence_event.all %}
            <li id="occurrence-{{ occurrence.id }}" class="occurrenceItem{%if not occurrence.visible %} occurrenceItemExpired{% endif %}">
             <div class="title">
                <div class="dates">{% range_dates_as_tag occurrence.start occurrence.end 'span' %}</div>
                <div class="placename">
                    {% with occurrence.get_cities as cities %}
                     {% if cities %}
                        <a href="{{ cities.0.get_absolute_url }}" title="{{ cities.0.name }}">{{ cities.0 }}{% if not cities|length_is:"1" %}...{% endif %}</a>
                      {% endif %}
                    {% endwith %}
                </div>
            </div>
            <div class="info {% if show_moreoccurrences %}moreinfo{% endif %}">

                {% if occurrence.schedule %}
                    <h4>{% inline_trans "Schedule" %}</h4>
                    <div>{{ occurrence.schedule|safe }}</div>
                {% endif %}
                {% if occurrence.price %}
                    <h4>{% inline_trans "Price" %}</h4>
                    <div>{{ occurrence.price|safe }}</div>
                {% endif %}

                {% occurrence_address_info occurrence %}
                {% occurrence_contact_info occurrence %}
            </div>
            {% if show_moreoccurrences %}
            <div class="action less"><a href="#">{% trans "hide info" %}</a></div>
            <div class="action more"><a href="#occurrence-{{ occurrence.id }}">{% trans "show info" %}</a></div>
            {% endif %}
           </li>
        {% endfor %}
        </ul>
    {% endif %}
    {% endwith %}
{% else %}
    {% if content.start or content.end %}
        <h2>{% inline_trans "When & Where?" %}</h2>
        <ul class="occurrencelist">
        {% with content.occurrence_event.all|first as occurrence %}
            <li id="occurrence-{{ occurrence.id }}" class="occurrenceItem{%if not occurrence.visible %} occurrenceItemExpired{% endif %}">
             <div class="title">
                <div class="dates">
                    {% range_dates_as_tag content.start content.end 'span' %}
                </div>
                <div class="placename">
                    {% with occurrence.get_cities as cities %}
                     {% if cities %}
                        <a href="{{ cities.0.get_absolute_url }}" title="{{ cities.0.name }}">{{ cities.0 }}{% if not cities|length_is:"1" %}...{% endif %}</a>
                      {% endif %}
                    {% endwith %}
                </div>
            </div>
            <div class="info {% if show_moreoccurrences %}moreinfo{% endif %}">

                {% if occurrence.schedule %}
                    <h4>{% inline_trans "Schedule" %}</h4>
                    <div>{{ occurrence.schedule|safe }}</div>
                {% endif %}
                {% if occurrence.price %}
                    <h4>{% inline_trans "Price" %}</h4>
                    <div>{{ occurrence.price|safe }}</div>
                {% endif %}

                {% occurrence_address_info occurrence %}
                {% occurrence_contact_info occurrence %}
            </div>
           </li>
        {% endwith %}
        </ul>
        
    {% endif %}
{% endif %}


{% google_map content_pois=event_pois %}
{% if event_pois|localized %}
  {% google_map_proximity_filter %}
{% endif %}

{% content_related_items content %}

{% endblock contentbody %}
