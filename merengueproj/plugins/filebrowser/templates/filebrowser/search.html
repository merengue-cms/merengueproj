{% extends "filebrowser/base.html" %}
{% load i18n inlinetrans truncate_filter filebrowser_tags %}

{% block pagetitle %}{{ block.super }} - {% trans "Search repositories" %}{% endblock %}

{% block parentextrabreadcrumbs %}

{% endblock %}

{% block extrabreadcrumbs %}
    {% if section %}
        {{ section.breadcrumbs }}
    {% endif %}
    <span class="breadcrumbSeparator">→</span><a href="{% filebrowser_url filebrowser_repositories %}">{% inline_trans "Repository List" %}</a>
    <span class="breadcrumbSeparator">→</span><a href="{% filebrowser_url filebrowser_search %}">{% inline_trans "Search" %}</a>
{% endblock %}

{% block content %}
<div id="content-title">
    <h1 title="{% trans "Search document repository" %}">{% inline_trans "Search document repository" %}</h1>
</div>

{% include "filebrowser/search.html.inc" %}

{% if files or documents %}
    <table id="webfs-table" title="{% trans "This table contains a list of objects" %}">
        <thead>
            <tr>
                <th class="name">{% inline_trans "Name" %}</th>
                <th class="size">{% inline_trans "Size" %}</th>
                <th class="modification-date" abbr="{% trans "Date" %}">{% inline_trans "Modification date" %}</th>
                <th class="last-empty"></th>
            </tr>
        </thead>
        <tbody>
         {% for f in files %}
            <tr class="{% cycle row1,row2 %}">
              <td class="contentTitle">
               <label for="file_{{ forloop.counter }}" class="file">
                 <a href="{% filebrowser_url filebrowser_download repository_name=f.repository.name,path=f.path %}" title="{{ f.description }}">{{ f.title|inline_truncate:40 }}</a>
               </label>
              </td>
              <td>{{ f.size|filesizeformat }}</td>
              <td colspan="2">{{ f.modificated|date:"d/m/Y" }}</td>
            </tr>
         {% endfor %}
         {% for doc in documents %}
            <tr class="{% cycle row1,row2 %}">
              <td class="contentTitle">
                <label for="doc_{{ forloop.counter }}" class="document">
                  <a href="{% filebrowser_url filebrowser_viewdoc repository_name=doc.repository.name,doc_slug=doc.slug %}" title="{{ doc.content }}">{{ doc.title|inline_truncate:40 }}</a>
                </label>
              </td>
              <td>{{ doc.get_size|filesizeformat }}</td>
              <td colspan="2">{{ doc.modification_date|date:"d/m/Y" }}</td>
            </tr>
         {% endfor %}
        </tbody>
    </table>
{% else %}
  {% if request.method == "POST" %}
  <div class="action-buttons">
    <p class="noContent">{% inline_trans "Your search matched no results." %}</p>
  </div>
  {% endif %}
{% endif %}

{% endblock %}
